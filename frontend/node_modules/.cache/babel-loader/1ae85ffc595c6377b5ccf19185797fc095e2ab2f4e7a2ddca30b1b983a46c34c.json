{"ast":null,"code":"import \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { mapActions, mapState } from \"vuex\";\nexport default {\n  name: \"Cart\",\n  props: {\n    cart: Object\n  },\n  data() {\n    return {\n      cc: null\n    };\n  },\n  computed: {\n    ...mapState([\"token\", \"currCart\"])\n  },\n  methods: {\n    ...mapActions([\"getToken\", \"getCart\", \"removeGameFromCart\", \"addReceipt\"]),\n    calcTotal(games) {\n      let total = 0;\n      games.forEach(gInCart => {\n        total += gInCart.price;\n      });\n      return total.toFixed(2);\n    },\n    removeFromCart(game, thiscart) {\n      console.log(JSON.stringify(game) + \" removed\");\n      let token = localStorage.token;\n      let payload = token.split(\".\")[1];\n      let user = JSON.parse(atob(payload));\n      const obj = {\n        game: game,\n        cart: thiscart,\n        user: user\n      };\n      this.removeGameFromCart(obj);\n      let c;\n      this.getCart(user).then(res => {\n        c = res;\n        console.log(\"RES \" + JSON.stringify(res));\n        document.getElementById(\"totalDiv\").innerHTML = \"\";\n        let t = (res.to_pay - game.price).toFixed(2);\n        if (t <= 0) t = 0;\n        document.getElementById(\"totalDiv\").innerHTML += `\n             <b> Total: ${(res.to_pay - game.price).toFixed(2).toString()} </b>\n              `;\n      });\n      this.$forceUpdate();\n\n      //namesteno trenutno da radi sa reload-om,\n      //TODO: namestiti da radi i bez reload-a\n      //location.reload();\n    },\n\n    createReceipt(cart) {\n      let token = localStorage.token;\n      let payload = token.split(\".\")[1];\n      let user = JSON.parse(atob(payload));\n      const rcpInfo = {\n        cart: cart,\n        user: user\n      };\n      console.log(\"pozivam addrcp iz view-a\");\n      this.addReceipt(rcpInfo);\n      this.$router.push({\n        name: \"Receipts\"\n      });\n    }\n  },\n  mounted() {}\n};","map":{"version":3,"mappings":";;AAqCA;AAEA;EACAA;EAEAC;IACAC;EACA;EAEAC;IACA;MACAC;IACA;EACA;EAEAC;IACA;EACA;EAEAC;IACA;IACAC;MACA;MACAC;QACAC;MACA;MACA;IACA;IACAC;MACAC;MACA;MACA;MACA;MACA;QACAC;QACAV;QACAW;MACA;MACA;MACA;MACA;QACAC;QACAH;QACAI;QACA;QACA;QACAA;AACA;AACA;MACA;MACA;;MAEA;MACA;MACA;IACA;;IACAC;MACA;MACA;MACA;MACA;QACAd;QACAW;MACA;MACAF;MACA;MACA;QAAAX;MAAA;IACA;EACA;EACAiB;AACA","names":["name","props","cart","data","cc","computed","methods","calcTotal","games","total","removeFromCart","console","game","user","c","document","createReceipt","mounted"],"sourceRoot":"src/components","sources":["Cart.vue"],"sourcesContent":["<template>\n  <div>\n    <h4>Your cart:</h4>\n    <div id=\"cartDiv\" v-if=\"token\">\n      <h3>Cart</h3>\n      <b-card v-for=\"item in currCart.games\" :title=\"item.title\" :key=\"item.id + Math.random()\">\n        <b-card-text> Price: {{ item.price }}$ Info: {{ item.info }} Id: {{ item.id }} </b-card-text>\n        <b-card-text class=\"ms-auto\">\n          <b-button\n            v-if=\"item\"\n            pill\n            class=\"ms-auto\"\n            id=\"refBtn\"\n            variant=\"danger\"\n            @click=\"removeFromCart(item, cart)\"\n            >Remove</b-button\n          >\n        </b-card-text>\n      </b-card>\n      <div id=\"totalDiv\">\n        <br />\n        <b> Total: {{ calcTotal(currCart.games).toString() }} </b>\n      </div>\n      <br />\n      <hr />\n      <div id=\"payDiv\">\n        <b-button pill class=\"ms-auto\" id=\"payBtn\" variant=\"success\" @click=\"createReceipt(currCart)\">\n          Checkout\n        </b-button>\n      </div>\n      <!--<h5>Total: {{ calcTotal(cart.games).toString() }}$</h5>-->\n    </div>\n    <p v-else>You must be signed in to view your cart.</p>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapState } from \"vuex\";\n\nexport default {\n  name: \"Cart\",\n\n  props: {\n    cart: Object,\n  },\n\n  data() {\n    return {\n      cc: null,\n    };\n  },\n\n  computed: {\n    ...mapState([\"token\", \"currCart\"]),\n  },\n\n  methods: {\n    ...mapActions([\"getToken\", \"getCart\", \"removeGameFromCart\", \"addReceipt\"]),\n    calcTotal(games) {\n      let total = 0;\n      games.forEach((gInCart) => {\n        total += gInCart.price;\n      });\n      return total.toFixed(2);\n    },\n    removeFromCart(game, thiscart) {\n      console.log(JSON.stringify(game) + \" removed\");\n      let token = localStorage.token;\n      let payload = token.split(\".\")[1];\n      let user = JSON.parse(atob(payload));\n      const obj = {\n        game: game,\n        cart: thiscart,\n        user: user,\n      };\n      this.removeGameFromCart(obj);\n      let c;\n      this.getCart(user).then((res) => {\n        c = res;\n        console.log(\"RES \" + JSON.stringify(res));\n        document.getElementById(\"totalDiv\").innerHTML = \"\";\n        let t = (res.to_pay - game.price).toFixed(2);\n        if (t <= 0) t = 0;\n        document.getElementById(\"totalDiv\").innerHTML += `\n             <b> Total: ${(res.to_pay - game.price).toFixed(2).toString()} </b>\n              `;\n      });\n      this.$forceUpdate();\n\n      //namesteno trenutno da radi sa reload-om,\n      //TODO: namestiti da radi i bez reload-a\n      //location.reload();\n    },\n    createReceipt(cart) {\n      let token = localStorage.token;\n      let payload = token.split(\".\")[1];\n      let user = JSON.parse(atob(payload));\n      const rcpInfo = {\n        cart: cart,\n        user: user,\n      };\n      console.log(\"pozivam addrcp iz view-a\");\n      this.addReceipt(rcpInfo);\n      this.$router.push({ name: \"Receipts\" });\n    },\n  },\n  mounted() {},\n};\n</script>\n\n<style scoped>\n.card {\n  margin-top: 10px;\n  text-align: left;\n}\n\n.card-title {\n  margin-bottom: 0px;\n}\n\n.card-body {\n  padding-bottom: 5px;\n}\n#refBtn {\n  right: auto;\n}\n#payDiv {\n  margin-top: 120px;\n}\n#payBtn {\n  float: right;\n  margin-right: 32px;\n  width: 128px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}